---
title: "HW 7 - Single Variable Analysis- Guide"
author: "Jose Rico"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output: 
  html_document:
    toc: true
    toc_float : true
    theme: cosmo
    highlight: tango
---
# Set-up
```{r set chunk option, echo=F}
knitr::opts_chunk$set(echo = F, warning=FALSE, message=FALSE, fig.height=4, fig.align='center') #Chunk default settings 
```

```{r library packages}
library(dplyr)
library(ggplot2)
library(janitor)
library(kableExtra)
library(infer)
library(mosaic)
```

```{r set ggplot2 parameters}
theme_update(plot.title = element_text(hjust = 0.5))
```

```{r load data}
load("/cloud/project/data/demo_addhealth_clean.Rdata")

```


# Table of Variables

Original Variable  |   New Variable  |    Description
-------------------|-----------------|------------------
RACE  |  race_c  | subject's race
BIO_SEX4 | gender | subject's gender
--  |  age | subject's age
H4ED2 | college_deg | Dd you complete college (bachelor's degree)?
H4DA11 | vigorous_activity | In the past 24 hours, have you participated in vigorous physical activity long enough to work up a sweat, get your heart thumping, or get out of breath?
H4MH23 | too_tired | (During the past seven days:) You felt that you were too tired to do things.
H4LM19 | hrs_worked_week | How many hours a week (do/did) you usually work at this job?

# Examing categorical variable 
## 1st Categorical `vigorous_activity`

**Numerical Summary Table**  

```{r summary table cat 1}
  demo %>% 
  filter(vigorous_activity=="yes" | vigorous_activity=="no") %>% 
  droplevels() %>% 
  tabyl(vigorous_activity) %>%
  adorn_pct_formatting(digits=1) %>%
  adorn_totals()%>%
  kable() %>%
  kable_styling(full_width = F, position="center")
```

**Bar Plot - Frequency of Levels**

```{r bar plot cat 1}
demo %>% 
  filter(vigorous_activity=="yes" | vigorous_activity=="no") %>% 
  droplevels() %>% 
  ggplot(aes(x=vigorous_activity, y= ..prop.., group=1)) +
    geom_bar(fill="steelblue", width=0.5) +
      ggtitle("In the past 24 hours, have you participated in vigorous physical activity long 
enough to work up a sweat, get your heart thumping, or get out of breath?") +
      xlab("subject's response")
  
```

**Inference (CI and Test of Significance)**
```{r}
vig_act <- demo %>% 
  select(vigorous_activity) %>% 
  filter(vigorous_activity=="yes" | vigorous_activity=="no") %>% 
  droplevels() 



```
```{r, echo=T}
prop.test(~vigorous_activity == "no", data = vig_act)
```


**Summary of Analysis**

<div id = "narrative">
The participants in the **addhealth** study were asked, "*In the past 24 hours, have you participated in vigorous physical activity long enough to work up a sweat, get your heart thumping, or get out of breath?*  

* 3056 out of 5111 (59.8%) of participants in the study answered "no".  
* Our sample proportion of 59.8% represents a statistically significant majority (greater than 50%, p-value < 2.2e-16)
* 95% confidence interval for non-participation in vigorous activity is 58.4% to 61.1%  (output from **mosaic**'s `prop.test` function)
</div>

# Examining numerical variable 
## 1st Numerical `sub_weight`

**Numerical Summary Table** 

```{r summarize num 1}
demo %>% 
  filter(sub_weight < 526) %>% 
  
  summarize(n = n(),
            min = min(sub_weight),
            q1 = quantile(sub_weight, probs=0.25),
            median = median(sub_weight),
            mean = mean(sub_weight),
            q3 = quantile(sub_weight, probs=0.75),
            max = max(sub_weight),
            sd = sd(sub_weight)) %>% 

  kable() %>% 
    kable_styling(full_width = F, position="center")
```


**Histogram - visualization of the distribution**

```{r hist num 1}
demo %>%
  filter(sub_weight < 121) %>% 
  ggplot(aes(x=sub_weight)) + 
    geom_histogram(aes(y=..density..), color="white", fill="steelblue", binwidth = 5) + 
      xlab("hours per week") +
      ggtitle("How many hours a week (do/did) you usually work at this job?") 
```

**Boxplot - visualization of 5 number summary**

```{r boxplot num 1}
demo %>%
  filter(sub_weight < 121) %>% 
  ggplot(aes(y=sub_weight, x=0)) + 
    geom_boxplot(color="steelblue", width=0.6) + 
      ggtitle("How many hours a week (do/did) you usually work at this job?")+
  coord_flip()
```



**Narrative Summary**
<div id = "narrative">

Participants were asked, in reference to their curren or most recent job (which they work more than 10 hours/week), "*How many hours a week (do/did) you usually work at this job?*"  

* **5023** out of **5114** responded with hours between 10 and 120.  
  
* **82** participants were a **legitimate skip** since they have not worked a paying job for at least 10 hours a week, they are not represented here.  

The center of the distribution is best described with the **mode** and **median** of 40 hours/week.   There is considerable overall variation as hours vary from 10 to 120, although the middle 50% of particpants are between 40 and 45 hours, for an interquartile range (**IQR**) of 5 hours.  Weekly work hours is *slightly skewed to the **right*** (since outliers extend, to the right, to 120 hours).  This skew also results in the **mean** being greater than the **median**, which is a typically characteristic of right skewed distributions. 
</div>



additional work
## Inference (CI and Test of Significance)
```{r}
## need to first filter your data frame
td <- demo %>% 
  filter(vigorous_activity=="yes" | vigorous_activity=="no") %>% 
  droplevels()

## then you can run a your test 
 # prop.test(td$vigorous_activity == "yes", correct = FALSE)  ### error in knit 
  
  binom.test(~(vigorous_activity == "yes"), conf.level = 0.95, ci.method = "Wald", data = td)
  
  chisq.test(table(td$vigorous_activity), p=c(1/2,1/2))
  
  table(td$vigorous_activity)
  
  xchisq.test(table(td$vigorous_activity), p=c(1/2,1/2)) ## extra p argument is needed for goodness of fit
  
  xchisq.test(td$vigorous_activity ~ td$gender)
```




